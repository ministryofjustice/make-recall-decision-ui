{% if flags.dateFilters or flags.contactTypesFilter %}
    <div class="govuk-grid-column-one-third-from-desktop">
        {%- set filterOptionsHtml %}
            {% if flags.dateFilters %}
            {{ govukDateInput({
                id: "dateFrom",
                namePrefix: "dateFrom",
                fieldset: {
                    legend: {
                        html: "Date range<span class='govuk-visually-hidden'> From</span>",
                        classes: "govuk-fieldset__legend--s"
                    }
                },
                items: dateTimeItems("dateFrom", caseSummary.filters.dateRange.dateFrom),
                errorMessage: errorMessage(errors.dateFrom)
            }) }}
            {{ govukDateInput({
                id: "dateTo",
                namePrefix: "dateTo",
                fieldset: {
                    legend: {
                        html: "<span class='govuk-visually-hidden'>Date range </span>To",
                        classes: "govuk-fieldset__legend--s"
                    }
                },
                items: dateTimeItems("dateTo", caseSummary.filters.dateRange.dateTo),
                errorMessage: errorMessage(errors.dateTo)
            }) }}
            {% endif %}
            {% if flags.contactTypesFilter %}
            {{ govukCheckboxes({
                idPrefix: "contactTypes",
                name: "contactTypes",
                classes: "govuk-checkboxes--small",
                fieldset: {
                    legend: {
                        text: "Contact type",
                        classes: "govuk-fieldset__legend--s"
                    }
                },
                items: checkboxItems({ items: caseSummary.filters.contactTypes.allContactTypes, currentValues: caseSummary.filters.contactTypes.selectedIds })
            }) }}
            {% endif %}
        {% endset -%}
        <div class='govuk-!-margin-bottom-4'>
            <form>
                {{ mojFilter({
                    heading: {
                        text: 'Filter'
                    },
                    selectedFilters: {
                        heading: {
                            text: 'Selected filters'
                        },
                        clearLink: {
                            text: 'Clear filters',
                            href: urlInfo.path
                        },
                        categories: [{
                            heading: {
                                text: 'Date range'
                            },
                            items: selectedFilterItems({ items: caseSummary.filters.dateRange.selected, urlInfo: urlInfo })
                        } if caseSummary.filters.dateRange.selected else undefined,
                        {
                            heading: {
                                text: 'Contact type'
                            },
                            items: selectedFilterItems({ items: caseSummary.filters.contactTypes.selected, urlInfo: urlInfo })
                        } if caseSummary.filters.contactTypes.selected else undefined
                        ]
                    } if caseSummary.hasActiveFilters else undefined,
                    optionsHtml: filterOptionsHtml
                }) }}
            </form>
        </div>
    </div>
{% endif %}
