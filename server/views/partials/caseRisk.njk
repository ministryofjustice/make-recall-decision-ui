<h1 class='govuk-heading-m govuk-visually-hidden'>Risk<span
            class='govuk-visually-hidden'> for {{ caseSummary.personalDetailsOverview.name }}</span></h1>
<div class="flex-desktop flex--row-reverse">
    <div class="flex__item-one-third-desktop">
        <div data-qa='roshTable'>
        {{ roshWidget({ riskOfSeriousHarm: caseSummary.roshSummary if caseSummary.roshSummary.error else caseSummary.roshSummary.riskOfSeriousHarm, lastUpdatedDate: formatDateTimeFromIsoString({ isoDate: caseSummary.roshSummary.lastUpdatedDate, dateOnly: true }) }) }}
        </div>
        <div data-qa='mappa'>
            {{ mappaWidget({ mappa: caseSummary.mappa, lastUpdatedDate: formatDateTimeFromIsoString({ isoDate: caseSummary.mappa.lastUpdatedDate, dateOnly: true }) }) }}
        </div>
        <div class="govuk-body predictor-timeline__heading">
            <h2 class="govuk-heading-m">Scores history</h2>
            <a id="predictor-timeline__toggle-all" href="#" class="govuk-link">Open all</a>
        </div>
        {% if caseSummary.predictorScores.historical %}
            {{ predictorTimeline(caseSummary.predictorScores.historical) }}
        {% elseif caseSummary.predictorScores.error == 'NOT_FOUND' %}
            <p class='govuk-body' data-qa='score-history-missing'>No history found.</p>
        {% elseif caseSummary.predictorScores.error and caseSummary.predictorScores.error != 'NOT_FOUND' %}
            <p class='govuk-body' data-qa='score-history-missing'>An error occurred getting the scores history.</p>
        {% endif %}
    </div>
    <div class="flex__item-two-thirds-desktop govuk-!-padding-right-4">
        {% if caseSummary.assessmentStatus === 'INCOMPLETE' %}
            <div class='govuk-!-margin-bottom-6'>
                {% include './notificationBanners/latestCompleteAssessment.njk' %}
            </div>
        {% endif %}
        {{ oasysCard({
            cardHeading: 'Who is at risk',
            oasysHeading: 'OASys 10.1 Who is at risk?',
            error: caseSummary.roshSummary.error,
            content: caseSummary.roshSummary.whoIsAtRisk,
            lastUpdated: caseSummary.roshSummary.lastUpdatedDate,
            attributes: {
                'data-js': 'viewDetail',
                'data-analytics-category': 'riskViewDetail',
                'data-analytics-label': 'Who is at risk'
            },
            dataQaAttr: 'whoIsAtRisk'
        }) }}
        {{ oasysCard({
            cardHeading: 'Details of the risk',
            oasysHeading: 'OASys 10.2 What is the nature of the risk?',
            error: caseSummary.roshSummary.error,
            content: caseSummary.roshSummary.natureOfRisk,
            lastUpdated: caseSummary.roshSummary.lastUpdatedDate,
            attributes: {
                'data-js': 'viewDetail',
                'data-analytics-category': 'riskViewDetail',
                'data-analytics-label': 'Details of the risk'
            },
            dataQaAttr: 'natureOfRisk'
        }) }}
        {{ oasysCard({
            cardHeading: 'When the risk will be highest',
            oasysHeading: 'OASys 10.3 When is the risk likely to be greatest?',
            error: caseSummary.roshSummary.error,
            content: caseSummary.roshSummary.riskImminence,
            lastUpdated: caseSummary.roshSummary.lastUpdatedDate,
            attributes: {
                'data-js': 'viewDetail',
                'data-analytics-category': 'riskViewDetail',
                'data-analytics-label': 'When the risk will be highest'
            },
            dataQaAttr: 'riskImminence'
        }) }}
        {{ oasysCard({
            cardHeading: 'Circumstances that will increase the risk',
            oasysHeading: 'OASys 10.4 What circumstances are likely to increase the risk?',
            error: caseSummary.roshSummary.error,
            content: caseSummary.roshSummary.riskIncreaseFactors,
            lastUpdated: caseSummary.roshSummary.lastUpdatedDate,
            attributes: {
                'data-js': 'viewDetail',
                'data-analytics-category': 'riskViewDetail',
                'data-analytics-label': 'Circumstances that will increase the risk'
            },
            dataQaAttr: 'riskIncreaseFactors'
        }) }}
        {{ oasysCard({
            cardHeading: 'Factors that will reduce the risk',
            oasysHeading: 'OASys 10.5 What factors are likely to reduce the risk?',
            error: caseSummary.roshSummary.error,
            content: caseSummary.roshSummary.riskMitigationFactors,
            lastUpdated: caseSummary.roshSummary.lastUpdatedDate,
            attributes: {
                'data-js': 'viewDetail',
                'data-analytics-category': 'riskViewDetail',
                'data-analytics-label': 'Factors that will reduce the risk'
            },
            dataQaAttr: 'riskMitigationFactors'
        }) }}
        <h2 class="govuk-heading-m score-header govuk-!-margin-bottom-2">
            Risk of serious recidivism (RSR) score{% if caseSummary.predictorScores.current.RSR.score %} - {{ caseSummary.predictorScores.current.RSR.score }}%{% endif %}
        </h2>
        {% if caseSummary.predictorScores.current.RSR.score %}
            {{ predictorScore(caseSummary.predictorScores.current.RSR) }}
        {% else %}
            <p class='govuk-body' data-qa='rsr-missing'>Not available.</p>
        {% endif %}
        <h2 class="govuk-heading-m score-header">
            OGRS score - {{ caseSummary.predictorScores.current.OGRS.score }}
        </h2>

        {% if caseSummary.predictorScores.current.OSPC.score or caseSummary.predictorScores.current.OSPI.score %}
        <div class="govuk-grid-row">
            {% if caseSummary.predictorScores.current.OSPC.score %}
            <div class="govuk-grid-column-one-half-from-desktop">
                <h2 class="govuk-heading-m score-header govuk-!-margin-bottom-2">
                    OSP/C score
                </h2>
                {{ predictorScore(caseSummary.predictorScores.current.OSPC) }}
            </div>
            {% endif %}
            {% if caseSummary.predictorScores.current.OSPI.score %}
            <div class="govuk-grid-column-one-half-from-desktop">
                <h2 class="govuk-heading-m score-header govuk-!-margin-bottom-2">
                    OSP/I score
                </h2>
                {{ predictorScore(caseSummary.predictorScores.current.OSPI) }}
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>