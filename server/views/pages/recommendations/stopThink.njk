{% extends "../../partials/layout.njk" %}

{% set pageTitle = makePageTitle({ pageHeading: pageTitles[page.id], hasErrors: errors }) %}

{% block beforeContent %}
    <nav>
        {{ govukBackLink({
            text: "Back",
            href: '/recommendations/' + recommendation.id + '/alternatives-tried'
        }) }}
    </nav>
{% endblock %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
            {% if flags.flagConsiderRecall == true %}
                {% set infoHtml %}
                    {% if recommendation.managerRecallDecision.selected.value %}
                        <p class='info-panel__body'>Manager: {{ recommendation.managerRecallDecision.createdBy }}</p>
                        <p class='info-panel__body'>Date: {{ formatDateTimeFromIsoString({isoDate: recommendation.managerRecallDecision.createdDate, dateOnly: true }) }}</p>
                        <p class='info-panel__body'>Decision: {{ getDisplayValueForOption({ value: recommendation.managerRecallDecision.selected.value, allOptions: formOptions.recallTypeManager }) }}</p>
                        <div>
                        <a class='govuk-button govuk-button--secondary govuk-!-margin-bottom-0'
                           href='/recommendations/{{ recommendation.id }}/is-indeterminate'>Continue</a>
                    {% else %}
                        <p class='info-panel__body'>Public safety is vital. But make sure recall is the right thing to
                            do.</p>
                        <p class='info-panel__body'>Discuss and review this case with a manager - think about these questions:</p>
                        <ul class='info-panel__body govuk-list govuk-list--bullet govuk-!-margin-bottom-8'>
                            <li>What does the Risk Management Plan say?</li>
                            <li>What does the Contingency Plan say?</li>
                            <li>Can the risk be managed in the community?</li>
                            <li>What else can you do to manage the risk?</li>
                            <li>What type of sentence is the person on?</li>
                            <li>Has the recall threshold of the personâ€™s sentence been met?</li>
                        </ul>
                        <h2 class='info-panel__body govuk-!-font-weight-bold'>What happens next</h2>
                        <p class='info-panel__body'>The manager will record the final decision. Then you can continue from this page.</p>
                    {% endif %}
                {% endset %}
                {{ infoPanel({
                    titleText: "Reviewed by manager" if recommendation.managerRecallDecision.selected.value else "Review with a manager",
                    html: infoHtml
                }) }}
            {% else %}
                {% set infoHtml %}
                    <p class='info-panel__body'>Public safety is vital. But make sure recall is the right thing to
                        do.</p>
                    <p class='info-panel__body'>Think about these questions:</p>
                    <ul class='info-panel__body govuk-list govuk-list--bullet govuk-!-margin-bottom-8'>
                        <li>What does the Risk Management Plan say?</li>
                        <li>What does the Contingency Plan say?</li>
                        <li>Can the risk be managed in the community?</li>
                        <li>What else can you do to manage the risk?</li>
                    </ul>
                    <a class='govuk-button govuk-button--secondary govuk-!-margin-bottom-0'
                       href='/recommendations/{{ recommendation.id }}/is-indeterminate'>Continue</a>
                {% endset %}
                {{ infoPanel({
                    titleText: "Stop and think",
                    html: infoHtml
                }) }}
            {% endif %}
        </div>
    </div>
{% endblock %}

