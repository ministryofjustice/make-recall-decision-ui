{% extends "../../partials/layout.njk" %}

{% set pageTitle = makePageTitle({ pageHeading: pageTitles[page.id], hasErrors: errors }) %}

{% block beforeContent %}
    {{ backLink() }}
{% endblock %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds-from-desktop">

            <h1 class='govuk-heading-l'>{{ pageHeadings[page.id] }}</h1>

            <p class="govuk-body">
                You have selected this offence. These details are from NOMIS. Double-check everything. The details will go into PPUD.
            </p>

            <form novalidate method="post">
                <input type="hidden" name="_csrf" value="{{ csrfToken }}" />

                <dl class="govuk-summary-list govuk-!-margin-bottom-4">

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Sentence
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(offence.sentenceTypeDescription) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Offence
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(offence.offenceDescription) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Offence Date
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(offence.offenceDate) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Release date
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank( formatDateTimeFromIsoString({ isoDate: offence.releaseDate }) ) }}
                        </dd>

                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Releasing prison
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(offence.releasingPrison) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Sentencing court
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(offence.courtDescription) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Date of sentence
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(formatDateTimeFromIsoString({ isoDate: offence.sentenceDate })) }}
                        </dd>
                    </div>



                    {% if offence.terms.length < 2 %}
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Sentence length
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% for term in offence.terms %}
                                <div>{{ hyphenForBlank(formatTerm(term)) }}</div>
                            {% endfor %}
                            {% if not offence.terms.length %}
                                - <span class="govuk-visually-hidden">no value</span>
                            {% endif %}
                        </dd>
                    </div>
                    {% else %}
                    {% for term in offence.terms %}
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">
                                {% if term.code === "IMP" %}
                                    Custodial term
                                {% endif %}
                                {% if term.code === "LIC" %}
                                    Extended term
                                {% endif %}
                            </dt>
                            <dd class="govuk-summary-list__value">
                                <div>{{ hyphenForBlank(formatTerm(term))}}</div>
                            </dd>
                        </div>
                    {% endfor %}
                    {% endif %}

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Licence expiry date
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(formatDateTimeFromIsoString({ isoDate: offence.licenceExpiryDate})) }}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Sentence end date
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ hyphenForBlank(formatDateTimeFromIsoString({ isoDate: offence.sentenceEndDate})) }}
                        </dd>
                    </div>
                </dl>

                {{ formSubmitButton() }}
            </form>
        </div>
    </div>
{% endblock %}